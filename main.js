(()=>{"use strict";var t=document.querySelector("#card"),e=document.querySelector(".profile__edit-button"),o=document.querySelector(".profile__add-button"),n=(document.querySelector(".profile__title"),document.querySelector(".profile__subtitle"),document.querySelector(".popup-profile").querySelector(".popup__form"),document.querySelector(".popup-photo").querySelector(".popup__form"),document.querySelector(".discovery")),r=(n.querySelector(".discovery__img"),n.querySelector(".discovery__description"),document.querySelector(".profile__avatar-edit")),i={},u={},s={selectors:{photosImage:".photos__image",photosName:".photos__name",photosButtonLike:".photos__button-like",photosButtonDelete:".photos__button-delete",photosElement:".photos__element",photosButtonLikeActive:"photos__button-like_active",imagePopup:".discovery",imageDiscovery:".discovery__img",discoveryDescription:".discovery__description",openPopup:".popup_open"}},c={selectors:{inputError:"popup__input-text-type-error",spanError:"popup__input-text-error_active",inputClass:".popup__input-text",buttonClass:".popup__button-save",popupFormClass:".popup__form",buttonInactive:"popup__button-save_inactive",disabledButton:"disabled",idError:"-error",photoAddButton:o}};function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==a(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===a(r)?r:String(r)),n)}var r}var p=function(){function t(e,o,n,r,i,u,s){var c=e.name,a=e.link,l=e.likes,p=e.owner,f=e._id;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._templateSelector=n,this._link=a,this._name=c,this.likes=l,this._owner=p,this._id=f,this._userId=o,this._photosImageSelector=r.selectors.photosImage,this._photosNameSelector=r.selectors.photosName,this._photosButtonLikeSelector=r.selectors.photosButtonLike,this._photosButtonDeleteSelector=r.selectors.photosButtonDelete,this._photoElement=document.querySelector(r.selectors.photosElement),this._photosButtonLikeActiveSelector=r.selectors.photosButtonLikeActive,this._imagePopupSelector=r.selectors.imagePopup,this._imageDiscoverySelector=r.selectors.imageDiscovery,this._discoveryDescriptionSelector=r.selectors.discoveryDescription,this._handleCardClick=i,this._handleLikeCard=u,this._handleCardDelete=s}var e,o;return e=t,(o=[{key:"_getTemplate",value:function(){return this._templateSelector.content.cloneNode(!0)}},{key:"createCard",value:function(){return this._photoElement=this._templateSelector.content.cloneNode(!0),this._image=this._photoElement.querySelector(this._photosImageSelector),this._image.src=this._link,this._image.alt=this._name,this._buttonLike=this._photoElement.querySelector(".photos__button-like"),this._cardItem=this._photoElement.querySelector(".photos__element"),this._buttonDelete=this._photoElement.querySelector(".photos__button-delete"),this._countLike=this._photoElement.querySelector(".photos__like-count"),this._photoElement.querySelector(this._photosNameSelector).textContent=this._name,this._photoElementLike=this._photoElement.querySelector(this._photosButtonLikeSelector),this._photoElementDelete=this._photoElement.querySelector(this._photosButtonDeleteSelector),this._setEventListeners(),this.updateLikes(),this._compareId(),this._photoElement}},{key:"updateLikes",value:function(){this.statusLike()?(this._buttonLike.classList.add(this._photosButtonLikeActiveSelector),this._countLike.textContent=this.likes.length):this.statusLike()||(this._buttonLike.classList.remove(this._photosButtonLikeActiveSelector),this._countLike.textContent=this.likes.length)}},{key:"_compareId",value:function(){this._owner._id!==this._userId._id&&this._buttonDelete.remove()}},{key:"getId",value:function(){return this._id}},{key:"deleteCard",value:function(){this._cardItem.remove()}},{key:"statusLike",value:function(){var t=this;return this.likes.find((function(e){return e._id===t._userId._id}))}},{key:"_setEventListeners",value:function(){var t=this;this._buttonDelete.addEventListener("click",(function(){t._handleCardDelete(t)})),this._photoElementLike.addEventListener("click",(function(){t._handleLikeCard(t)})),this._image.addEventListener("click",(function(){return t._handleCardClick(t._link,t._name)}))}}])&&l(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function y(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function h(t,e,o){return(e=v(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function v(t){var e=function(t,e){if("object"!==f(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===f(e)?e:String(e)}var d=function(){function t(e,o){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),h(this,"_showInputError",(function(t,e){var o=n._formElement.querySelector(".".concat(t.id).concat(n._idError));t.classList.add(n._inputError),o.textContent=e,o.classList.add(n._spanError)})),h(this,"_checkInputValidity",(function(t){t.validity.valid?n._hideInputError(t):n._showInputError(t,t.validationMessage)})),h(this,"_setEventListener",(function(){n._buttonState(),n._inputList.forEach((function(t){t.addEventListener("input",(function(){n._checkInputValidity(t),n._buttonState()}))}))})),h(this,"_invalidInput",(function(){return n._inputList.some((function(t){return!t.validity.valid}))})),h(this,"_buttonState",(function(){n._invalidInput()?(n._buttonElement.classList.add(n._buttonInactive),n._buttonElement.setAttribute(n._disabledButton,"")):(n._buttonElement.classList.remove(n._buttonInactive),n._buttonElement.removeAttribute(n._disabledButton))})),this._inputError=e.selectors.inputError,this._spanError=e.selectors.spanError,this._inputClass=e.selectors.inputClass,this._buttonClass=e.selectors.buttonClass,this._popupFormClass=e.selectors.popupFormClass,this._buttonInactive=e.selectors.buttonInactive,this._disabledButton=e.selectors.disabledButton,this._idError=e.selectors.idError,this._formElement=o,this._inputList=Array.from(o.querySelectorAll(e.selectors.inputClass)),this._buttonElement=o.querySelector(e.selectors.buttonClass)}var e,o;return e=t,(o=[{key:"_hideInputError",value:function(t){this._formElement.querySelector(".".concat(t.id).concat(this._idError)).textContent=""}},{key:"enableValidation",value:function(){this._setEventListener()}},{key:"_resetValidation",value:function(){var t=this;this._buttonState(),this._inputList.forEach((function(e){t._hideInputError(e)}))}},{key:"clearValidation",value:function(){this._resetValidation()}}])&&y(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function _(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==b(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===b(r)?r:String(r)),n)}var r}var m=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._title=document.querySelector(e.title),this._subtitle=document.querySelector(e.subtitle),this._avatar=document.querySelector(e.avatar),this.setUserInfo=this.setUserInfo.bind(this),this.getUserInfo=this.getUserInfo.bind(this)}var e,o;return e=t,(o=[{key:"getUserInfo",value:function(){return{name:this._title.textContent,about:this._subtitle.textContent}}},{key:"setUserInfo",value:function(t){var e=t.name,o=t.about,n=t.avatar,r=t._id;this._title.textContent=e,this._subtitle.textContent=o,this._avatar.src=n,this._id=r}}])&&_(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function g(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k(n.key),n)}}function E(t,e,o){return(e=k(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function k(t){var e=function(t,e){if("object"!==S(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===S(e)?e:String(e)}var w=function(){function t(e){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),E(this,"_closeByEscape",(function(t){"Escape"===t.key&&o.closePopup()})),E(this,"_handleOverlayClose",(function(t){t.target===o._popup&&o.closePopup()})),this._popup=document.querySelector(e),this._button=this._popup.querySelector(".popup__profile-close"),this.openPopup=this.openPopup.bind(this),this.closePopup=this.closePopup.bind(this)}var e,o;return e=t,(o=[{key:"openPopup",value:function(){this._popup.classList.add("popup_open"),this._setDefEventListeners()}},{key:"closePopup",value:function(){this._popup.classList.remove("popup_open"),this._deleteDefEventListeners()}},{key:"_setDefEventListeners",value:function(){document.addEventListener("keydown",this._closeByEscape),this._popup.addEventListener("mousedown",this._handleOverlayClose)}},{key:"_deleteDefEventListeners",value:function(){document.removeEventListener("keydown",this._closeByEscape),this._popup.removeEventListener("mousedown",this._handleOverlayClose)}},{key:"setEventListeners",value:function(){var t=this;this._button.addEventListener("click",(function(){t.closePopup()}))}}])&&g(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function L(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==P(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===P(r)?r:String(r)),n)}var r}function O(){return O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=I(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:o):r.value}},O.apply(this,arguments)}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}function C(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}(u,t);var e,o,n,r,i=(n=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=I(n);if(r){var o=I(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return C(t)}(this,t)});function u(t,e){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,t))._submit=e,o._form=o._popup.querySelector(".popup__form"),o._inputsForm=o._form.querySelectorAll(".popup__input-text"),o.closePopup=o.closePopup.bind(C(o)),o._buttonSave=o._form.querySelector(".popup__button-save"),o._buttonSaveText=o._buttonSave.textContent,o}return e=u,o=[{key:"rendererLoading",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Сохранение...";this._buttonSave.textContent=!0===t?e:this._buttonSaveText}},{key:"_getInputValues",value:function(){var t=this;return this._arrValuesInputs={},this._inputsForm.forEach((function(e){t._arrValuesInputs[e.name]=e.value})),this._arrValuesInputs}},{key:"setInputValues",value:function(t){this._inputsForm.forEach((function(e){e.value=t[e.name]}))}},{key:"setEventListeners",value:function(){var t=this;O(I(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(e){e.preventDefault(),t._submit(t._getInputValues())}))}},{key:"closePopup",value:function(){O(I(u.prototype),"closePopup",this).call(this),this._form.reset()}}],o&&L(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),u}(w);function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function T(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==q(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===q(r)?r:String(r)),n)}var r}function R(){return R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:o):r.value}},R.apply(this,arguments)}function B(t,e){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},B(t,e)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}var U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B(t,e)}(u,t);var e,o,n,r,i=(n=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=x(n);if(r){var o=x(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return A(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._image=e._popup.querySelector(".discovery__img"),e._subtitle=e._popup.querySelector(".discovery__description"),e.openPopup=e.openPopup.bind(A(e)),e}return e=u,(o=[{key:"openPopup",value:function(t,e){R(x(u.prototype),"openPopup",this).call(this),this._image.src=t,this._image.alt=e,this._subtitle.textContent=e}}])&&T(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),u}(w);function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function N(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==V(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===V(r)?r:String(r)),n)}var r}var F=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._renderer=e,this._container=document.querySelector(o),this.renderItems=this.renderItems.bind(this)}var e,o;return e=t,(o=[{key:"renderItems",value:function(t){var e=this;t.reverse().forEach((function(t){e.addItem(e._renderer(t))}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&N(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function H(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==G(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===G(r)?r:String(r)),n)}var r}var M=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=e.myUrl,this._headers=e.headers,this._setData=this._setData.bind(this)}var e,o;return e=t,(o=[{key:"_checkResponse",value:function(t){return t.ok?t.json():Promise.reject("Ошибка ".concat(t))}},{key:"_getData",value:function(t,e){var o=this;return fetch("".concat(this._baseUrl,"/").concat(t),{method:e,headers:this._headers}).then((function(t){return o._checkResponse(t)}))}},{key:"_setData",value:function(t,e,o){return fetch("".concat(this._baseUrl,"/").concat(t),{method:e,headers:this._headers,body:JSON.stringify(o)}).then(this._checkResponse)}},{key:"getStartDataUser",value:function(){return this._getData("users/me","GET")}},{key:"editUser",value:function(t){return this._setData("users/me","PATCH",t)}},{key:"getCards",value:function(){return this._getData("cards","GET")}},{key:"createNewCard",value:function(t){return this._setData("cards","POST",t)}},{key:"deleteLike",value:function(t){return this._getData("cards/".concat(t,"/likes"),"DELETE")}},{key:"putLike",value:function(t){return this._getData("cards/".concat(t,"/likes"),"PUT")}},{key:"deleteCard",value:function(t){return this._getData("cards/".concat(t),"DELETE")}},{key:"patchAvatar",value:function(t){var e=t.avatar;return this._setData("users/me/avatar","PATCH",{avatar:e})}}])&&H(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function J(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==z(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===z(r)?r:String(r)),n)}var r}function $(){return $="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Q(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:o):r.value}},$.apply(this,arguments)}function K(t,e){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},K(t,e)}function Q(t){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Q(t)}var W=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&K(t,e)}(u,t);var e,o,n,r,i=(n=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Q(n);if(r){var o=Q(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._submit=o,e._form=e._popup.querySelector(".popup__form"),e}return e=u,(o=[{key:"setActionSubmit",value:function(t){this._submit=t}},{key:"setEventListeners",value:function(){var t=this;$(Q(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(e){e.preventDefault(),t._submit()}))}}])&&J(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),u}(w);function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}var Y,Z=new M({myUrl:"https://nomoreparties.co/v1/cohort-73",headers:{authorization:"971e39b8-a27e-431a-ad97-ff510d1ae105","Content-Type":"application/json"}}),tt=new U(s.selectors.imagePopup),et=new m({title:".profile__title",subtitle:".profile__subtitle",avatar:".profile__avatar"}),ot=new F(ct,".photos__grid"),nt=new D(".popup-profile",(function(t){nt.rendererLoading(!0),Z.editUser(t).then((function(t){et.setUserInfo(t),nt.closePopup()})).catch((function(t){return console.log(t)})).finally((function(){return nt.rendererLoading(!1)}))})),rt=new D(".popup-photo",(function(t){rt.rendererLoading(!0,"Создание..."),Z.createNewCard(t).then((function(t){ot.addItem(ct(t)),rt.closePopup()})).catch((function(t){return console.log(t)})).finally((function(){return rt.rendererLoading(!1,"Создать")}))})),it=new W(".popup-delete-card",null),ut=new D(".popup-avatar",(function(t){ut.rendererLoading(!0,"Создание..."),Z.patchAvatar(t).then((function(t){et.setUserInfo(t),ut.closePopup()})).catch((function(t){return console.log(t)})).finally((function(){return ut.rendererLoading(!1,"Создать")}))})),st=Array.from(document.querySelectorAll(c.selectors.popupFormClass));function ct(e){return new p(e,u,t,s,tt.openPopup,at,lt).createCard()}function at(t){(t.statusLike()?Z.deleteLike(t._id):Z.putLike(t._id)).then((function(e){t.likes=e.likes,t.updateLikes()})).catch((function(t){return console.log(t)}))}function lt(t){it.openPopup(),it.setActionSubmit((function(){Z.deleteCard(t.getId()).then((function(){t.deleteCard(),it.closePopup()})).catch((function(t){return console.log(t)}))}))}Y=c,st.forEach((function(t){var e=new d(Y,t),o=t.getAttribute("name");i[o]=e,e.enableValidation()})),e.addEventListener("click",(function(){nt.openPopup(),nt.setInputValues(et.getUserInfo()),i.profile.clearValidation()})),o.addEventListener("click",(function(){rt.openPopup(),i.photo.clearValidation()})),r.addEventListener("click",(function(){ut.openPopup(),i.avatar.clearValidation()})),tt.setEventListeners(),nt.setEventListeners(),rt.setEventListeners(),it.setEventListeners(),ut.setEventListeners(),Promise.allSettled([Z.getStartDataUser(),Z.getCards()]).then((function(t){var e,o,n=(o=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var n,r,i,u,s=[],c=!0,a=!1;try{if(i=(o=o.call(t)).next,0===e){if(Object(o)!==o)return;c=!1}else for(;!(c=(n=i.call(o)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){a=!0,r=t}finally{try{if(!c&&null!=o.return&&(u=o.return(),Object(u)!==u))return}finally{if(a)throw r}}return s}}(e,o)||function(t,e){if(t){if("string"==typeof t)return X(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?X(t,e):void 0}}(e,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=n[0].value,i=n[1].value;et.setUserInfo(r),u._id=r._id,ot.renderItems(i)}))})();